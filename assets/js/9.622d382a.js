(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{330:function(t,e,a){t.exports=a.p+"assets/img/auth.ee6f8530.png"},331:function(t,e,a){t.exports=a.p+"assets/img/component_auth.de9d6e8f.png"},363:function(t,e,a){"use strict";a.r(e);var s=a(33),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"用户授权"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户授权"}},[t._v("#")]),t._v(" 用户授权")]),t._v(" "),s("h2",{attrs:{id:"用户授权流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户授权流程"}},[t._v("#")]),t._v(" 用户授权流程")]),t._v(" "),s("p",[s("img",{attrs:{src:a(330),alt:"auth"}})]),t._v(" "),s("h3",{attrs:{id:"用户授权判断"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户授权判断"}},[t._v("#")]),t._v(" 用户授权判断")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("mpvue.getSetting")]),t._v("判断小程序是否获得权限")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("查看"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/open-api/setting/wx.getSetting.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"用户申请授权"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户申请授权"}},[t._v("#")]),t._v(" 用户申请授权")]),t._v(" "),s("p",[t._v("如果小程序未获得授权，我们需要提供用户主动申请授权的功能，微信规定获取用户信息，必须用户主动触发，此时我们需要借助"),s("code",[t._v("button")]),t._v("组件完成用户授权事件绑定，关键步骤：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@getuserinfo")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("getUserInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("open-type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("getUserInfo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  授权登录\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("关于"),s("code",[t._v("getuserinfo")]),t._v("和"),s("code",[t._v("open-type")]),t._v("的官方说明如下：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("open-type")]),t._v(" "),s("td",[t._v("微信开放能力")])]),t._v(" "),s("tr",[s("td",[t._v("bindgetuserinfo")]),t._v(" "),s("td",[t._v('用户点击该按钮时，会返回获取到的用户信息，回调的detail数据与wx.getUserInfo返回的一致，open-type="getUserInfo"时有效')])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("查看"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"获取用户信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取用户信息"}},[t._v("#")]),t._v(" 获取用户信息")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("mpvue.getUserInfo")]),t._v("获取用户信息")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("查看"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/open-api/user-info/wx.getUserInfo.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"获取openid"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取openid"}},[t._v("#")]),t._v(" 获取openId")]),t._v(" "),s("p",[t._v("由于每个用户在每个小程序都会获得唯一的"),s("code",[t._v("openId")]),t._v("，所以"),s("code",[t._v("openId")]),t._v("非常适合用作用户的唯一标识，获取"),s("code",[t._v("openId")]),t._v("我们需要通过官方提供的"),s("code",[t._v("api")]),t._v(" "),s("code",[t._v("auth.code2Session")]),t._v("来获取，为了简化"),s("code",[t._v("api")]),t._v("调用，课程提供了该"),s("code",[t._v("api")]),t._v("的封装版本，"),s("a",{attrs:{href:"https://www.youbaobao.xyz/mpvue-docs/api/#%E8%8E%B7%E5%8F%96%E5%BE%AE%E4%BF%A1%E7%94%A8%E6%88%B7%E7%9A%84openid",target:"_blank",rel:"noopener noreferrer"}},[t._v("立即查看"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("查看"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/login/auth.code2Session.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"用户登录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户登录"}},[t._v("#")]),t._v(" 用户登录")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("mpvue.login")]),t._v("进行用户登录，登录后会获得"),s("code",[t._v("code")]),t._v("，该"),s("code",[t._v("code")]),t._v("可用于获取"),s("code",[t._v("openId")]),t._v("，但要注意"),s("code",[t._v("code")]),t._v("只能使用一次，用完即作废")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("查看"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"用户注册"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户注册"}},[t._v("#")]),t._v(" 用户注册")]),t._v(" "),s("p",[t._v("获得"),s("code",[t._v("openId")]),t._v("后，我们可以通过该"),s("code",[t._v("openId")]),t._v("和用户信息在小慕读书中进行注册，课程提供了注册的"),s("code",[t._v("api")]),t._v("，"),s("a",{attrs:{href:"https://www.youbaobao.xyz/mpvue-docs/api/#%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C",target:"_blank",rel:"noopener noreferrer"}},[t._v("立即查看"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"授权组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#授权组件"}},[t._v("#")]),t._v(" 授权组件")]),t._v(" "),s("p",[t._v("用户授权登录组件")]),t._v(" "),s("p",[s("img",{attrs:{src:a(331),alt:"component_auth"}}),t._v(" "),s("table",[s("tr",[s("th",[t._v("组件名称")]),t._v(" "),s("th",[t._v("属性")]),t._v(" "),s("th",[t._v("参数")]),t._v(" "),s("th",[t._v("用途")]),t._v(" "),s("th",[t._v("默认值")])]),t._v(" "),s("tr",[s("td",{attrs:{rowspan:"11"}},[t._v("Auth")]),t._v(" "),s("td",[t._v("method")]),t._v(" "),s("td",[t._v("getUserInfo")]),t._v(" "),s("td",[t._v("获取用户信息")]),t._v(" "),s("td",[t._v("(空)")])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("LOGO图片地址："),s("a",{attrs:{href:"https://www.youbaobao.xyz/mpvue-res/logo.jpg",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.youbaobao.xyz/mpvue-res/logo.jpg"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=r.exports}}]);